<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bigwork.bigwork_apitest.dal.mapper.ChatDetailMapper">



    <sql id="columns">
        user_id,
        workspace_id,
        friend_id,
        content_user,
        content,
        gmt_update,
        type
    </sql>

    <resultMap id="resultMap" type="ChatDetailDo">
        <id property="userId" column="user_id"/>
        <result property="friendId" column="friend_id"/>
        <result property="contentUser" column="content_user"/>
        <result property="content" column="content"/>
        <result property="gmtUpdate" column="gmt_update"/>
        <result property="type" column="type"/>
        <result property="workspaceId" column="workspace_id"/>
    </resultMap>

    <insert id="add" useGeneratedKeys="true" keyProperty="id">
        insert into chat_detail_db(
        <include refid="columns"/>
        )
        values(
        #{userId},
        #{workspaceId},
        #{friendId},
        #{contentUser},
        #{content},
        #{gmtUpdate},
        #{type}
        )
    </insert>

    <select id="getChatDetailByRealOffset" resultMap="resultMap">
        select <include refid="columns"/>
        from chat_detail_db
        where user_id = #{userId}
        and friend_id = #{friendId}
        and workspace_id = #{workspaceId}
        order by gmt_update desc
        LIMIT #{realOffset},#{pageSize}
    </select>


</mapper>